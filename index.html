<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Math Line</title>
<style>
:root {
  --bg1: #000000;
  --bg2: #111111;
  --accent: #ff8800;
  --text-color: #f0f0f0;
}
body {
  margin:0; padding:0; font-family:'Poppins', sans-serif; color:var(--text-color);
  background: linear-gradient(-45deg,var(--bg1),var(--bg2));
  background-size:400% 400%; animation: moveBackground 12s ease infinite;
  overflow-x:hidden;
}
@keyframes moveBackground {
  0% {background-position:0% 50%;}
  50% {background-position:100% 50%;}
  100% {background-position:0% 50%;}
}
canvas#particles {
  position:fixed; top:0; left:0; width:100%; height:100%; z-index:-1; pointer-events:none;
}
header {
  padding:25px; text-align:center; position:relative; z-index:2;
}
header h1 {margin:0; font-size:2.8em; color:#fff; text-shadow:0 0 15px var(--accent);}
header p {margin:5px 0 0 0; color:#ffdb91; font-size:1.2em;}
#search-container {text-align:center; margin-top:20px;}
#search-input {padding:10px 15px; width:250px; font-size:16px; border-radius:8px; border:2px solid var(--accent); background:#1a0a0a; color:var(--accent);}
.game-list {
  display:flex; flex-wrap:wrap; justify-content:center; gap:20px; padding:50px 20px; position:relative; z-index:2;
}
.game-card {
  position:relative; background:rgba(0,0,0,0.6); border:2px solid var(--accent); border-radius:14px;
  width:230px; padding:25px; cursor:pointer; transition:transform .25s, box-shadow .25s; font-size:1.2em;
}
.game-card:hover {transform:scale(1.02); box-shadow:0 0 15px var(--accent);}
.star {
  position:absolute; top:8px; right:8px; font-size:18px; cursor:pointer;
}
.star.favorited {color:gold; text-shadow:0 0 8px var(--accent);}
iframe#game-frame {
  display:none; width:95%; height:650px; margin:0 auto; border:none; border-radius:14px; box-shadow:0 8px 20px rgba(0,0,0,0.6); background:#000;
}
.back-btn, .fullscreen-btn {
  display:none; position:fixed; padding:10px 20px; font-size:16px; border:none; border-radius:8px; background:var(--accent);
  color:#000; cursor:pointer; z-index:3;
}
.back-btn {top:100px; left:25px;}
.fullscreen-btn {top:100px; right:25px;}
footer {
  text-align:center; padding:20px; color:#ffdb91; background:#1a0a0a; border-top:2px solid var(--accent);
}
</style>
</head>
<body>

<canvas id="particles"></canvas>

<header>
<h1>Math Line üéÆ</h1>
<p>Play your games with favorites, search, and animated background!</p>
</header>

<div id="search-container">
<input type="text" id="search-input" placeholder="Search games..." oninput="filterGames()">
</div>

<div class="game-list" id="game-list"></div>

<button class="back-btn" id="back-btn" onclick="goBack()">‚¨Ö Back</button>
<button class="fullscreen-btn" id="fullscreen-btn" onclick="goFullscreen()">‚õ∂ Fullscreen</button>

<iframe id="game-frame"></iframe>

<footer>
<p>Made with ‚ù§Ô∏è by Math1ine</p>
</footer>

<script>
// --- PARTICLES ---
const canvas=document.getElementById('particles');
const ctx=canvas.getContext('2d');
canvas.width=innerWidth; canvas.height=innerHeight;
let particles=[];
for(let i=0;i<70;i++){
  particles.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:Math.random()*2+1,dx:(Math.random()-0.5)*0.5,dy:(Math.random()-0.5)*0.5});
}
function animateParticles(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="#ff8800";
  particles.forEach(p=>{
    ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill();
    p.x+=p.dx; p.y+=p.dy;
    if(p.x<0||p.x>canvas.width)p.dx*=-1;
    if(p.y<0||p.y>canvas.height)p.dy*=-1;
  });
  requestAnimationFrame(animateParticles);
}
animateParticles();
window.addEventListener('resize',()=>{canvas.width=innerWidth; canvas.height=innerHeight;});

// --- GAMES ---
const games=[
"Ragdoll Archers","Ragdoll Hit","Time Shooter","Retro Bowl","Snow Rider","Swords And Sandals",
"Crazy Cattle","Gladi Hoppers","Bit Planes","Final Earth2","Cluster Rush","Push Your Luck",
"Poly Track","Ragdoll Soccer","Jetpack Joy Ride","Learn To Fly 3","Malidin Stun Cars","Gun Spin",
"Age Of War","Moto X3M 2","Moto X3M Winter","Basketball Stars","Idle Breakout","Vex 8",
"Tiny Fishing","Drive Mad","Stick Man Hook","Learn To Fly 2","Line Rider","Unicycle Hero",
"Basket Random","1v1 Lol","Happy Wheels","Idle Dice","Idle Miner Tycoon","Johnny Upgrade",
"Jack Smith","Tunnel Rush","Duck Life 5","Duck Life 4","Mob Control","A Small World Cup",
"Escape Road","QWOP","Indian Truck Simulator","Mr Mine","Doge Miner","Draw Climber","Granny Online"
];

const gameList=document.getElementById("game-list");
let favorites=JSON.parse(localStorage.getItem("mlFavorites"))||[];

function toggleFavorite(name){
  if(favorites.includes(name)){favorites=favorites.filter(f=>f!==name);}
  else{favorites.push(name);}
  localStorage.setItem("mlFavorites",JSON.stringify(favorites));
  renderGames();
}

function loadGameByName(name){
  const folder=name.replace(/\s+/g,"-");
  const firstLetter=folder.charAt(0).toUpperCase()+folder.slice(1);
  const fileName=`${firstLetter}/${firstLetter}.html`;
  loadGame(fileName);
}

function loadGame(url){
  gameList.style.display="none";
  document.getElementById("back-btn").style.display="inline-block";
  document.getElementById("fullscreen-btn").style.display="inline-block";
  const frame=document.getElementById("game-frame");
  frame.src=url;
  frame.style.display="block";
  window.scrollTo(0,0);
}

function goBack(){
  gameList.style.display="flex";
  document.getElementById("back-btn").style.display="none";
  document.getElementById("fullscreen-btn").style.display="none";
  const frame=document.getElementById("game-frame");
  frame.src="";
  frame.style.display="none";
}

function goFullscreen(){
  const frame=document.getElementById("game-frame");
  if(frame.requestFullscreen) frame.requestFullscreen();
  else if(frame.webkitRequestFullscreen) frame.webkitRequestFullscreen();
  else if(frame.msRequestFullscreen) frame.msRequestFullscreen();
}

function renderGames(){
  gameList.innerHTML="";
  const sorted=[...games].sort((a,b)=>a.localeCompare(b));
  const favs=sorted.filter(g=>favorites.includes(g));
  const nonFavs=sorted.filter(g=>!favorites.includes(g));
  const allGames=[...favs,...nonFavs];

  allGames.forEach(name=>{
    const card=document.createElement("div");
    card.className="game-card";
    card.onclick=()=>loadGameByName(name);

    const star=document.createElement("div");
    star.className="star"+(favorites.includes(name)?" favorited":"");
    star.textContent=favorites.includes(name)?"‚≠ê":"‚òÜ";
    star.onclick=e=>{e.stopPropagation(); toggleFavorite(name);};

    const span=document.createElement("span");
    span.textContent=name;

    card.appendChild(star);
    card.appendChild(span);
    gameList.appendChild(card);
  });

  // Request card
  const request=document.createElement("div");
  request.className="game-card glow-card request-card";
  request.innerHTML=`<a href="https://docs.google.com/forms/d/e/1FAIpQLSevmKWapDp5CV1txbj9HlnanJkNoYr10ifpDQs6OvstLCckMA/viewform?usp=sharing" target="_blank" style="text-decoration:none;color:inherit;display:block;"><span>Request a Game</span></a>`;
  gameList.appendChild(request);
}

function filterGames(){
  const val=document.getElementById('search-input').value.toLowerCase();
  document.querySelectorAll('.game-card:not(.request-card) span').forEach(span=>{
    span.parentElement.style.display=span.textContent.toLowerCase().includes(val)?'block':'none';
  });
}

renderGames();
</script>

</body>
</html>
