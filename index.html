<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Math Line - Halloween Edition</title>
<style>
:root {
  --bg1: #000;
  --bg2: #ff6600;
  --accent: #ff8800;
  --header-color: #fff;
  --text-color: #f0f0f0;
  --card-bg: rgba(0,0,0,0.6);
  --card-radius: 14px;
  --hover-scale: 1.02;
  --card-font: 'Poppins', sans-serif;
}

body {
  margin:0; padding:0;
  font-family: var(--card-font);
  color: var(--text-color);
  background: linear-gradient(-45deg,var(--bg1),var(--bg2));
  background-size:400% 400%;
  animation: moveBackground 12s ease infinite;
  overflow-x: hidden;
}

@keyframes moveBackground {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

canvas#particles { position: fixed; top:0; left:0; width:100%; height:100%; z-index:-3; }

header { padding:25px; text-align:center; position:relative; z-index:2; }
header h1 { margin:0; font-size:2.8em; color:var(--header-color); text-shadow:0 0 15px var(--accent); }

#search-container { position:fixed; top:25px; left:25px; z-index:3; }
#search-input { padding:10px; border-radius:8px; border:2px solid var(--accent); background:#1a0a0a; color:var(--accent); }

#settings-btn { position:fixed; top:25px; right:25px; font-size:28px; background:none; border:none; cursor:pointer; color:var(--accent); z-index:3; }

#back-btn, #fullscreen-btn {
  position:fixed; padding:10px 20px; font-size:16px; border:none; border-radius:8px; background:var(--accent);
  cursor:pointer; z-index:3; display:none;
}
#back-btn { top:100px; left:25px; }
#fullscreen-btn { top:100px; right:25px; }

#settings-menu {
  position:fixed; top:0; right:-350px; width:320px; height:100%; background:rgba(0,0,0,0.95);
  color:#fff; display:flex; flex-direction:column; padding:20px; gap:10px; transition:right 0.3s ease; z-index:4; overflow-y:auto;
}
#settings-menu.open { right:0; }
#settings-menu h2 { margin-top:0; text-align:center; }
#settings-menu label { display:flex; justify-content:space-between; align-items:center; }
#settings-menu input, #settings-menu select { cursor:pointer; }
#settings-menu button { padding:8px; border:none; border-radius:6px; cursor:pointer; background:var(--accent); color:#000; font-weight:bold; transition:.2s; }
#settings-menu button:hover { filter: brightness(1.2); }

.game-list {
  display:flex; flex-wrap:wrap; justify-content:center; gap:20px; padding:100px 20px 50px; position:relative; z-index:2;
}
.game-card {
  position:relative; background:var(--card-bg); border:2px solid var(--accent); color:var(--accent);
  width:260px; padding:25px; border-radius:var(--card-radius); cursor:pointer; transition:transform .25s, box-shadow .25s; font-size:1.2em;
}
.game-card:hover { transform: scale(var(--hover-scale)); box-shadow:0 0 15px var(--accent); }
.star { position:absolute; top:8px; right:8px; font-size:16px; cursor:pointer; }
.star.favorited { color:gold; text-shadow:0 0 8px var(--accent); }

iframe#game-frame { display:none; width:95%; height:650px; margin:0 auto; border:none; border-radius:14px; box-shadow:0 8px 20px rgba(0,0,0,0.6); background:#000; }

.decoration { position:fixed; z-index:-1; pointer-events:none; font-size:30px; animation:float 10s linear infinite; }
@keyframes float { 0%{transform:translateY(0) rotate(0deg);} 50%{transform:translateY(-15px) rotate(15deg);} 100%{transform:translateY(0) rotate(-15deg);} }

</style>
</head>
<body>
<canvas id="particles"></canvas>

<header>
  <h1>Math Line üéÉ</h1>
</header>

<div id="search-container"><input type="text" id="search-input" placeholder="Search games..."></div>
<button id="settings-btn">‚öôÔ∏è</button>
<button id="back-btn">‚¨Ö Back</button>
<button id="fullscreen-btn">‚õ∂ Fullscreen</button>

<div id="settings-menu">
  <h2>Settings</h2>
  <label>Halloween Decorations: <input type="checkbox" id="toggle-decorations"></label>
  <label>Particles: <input type="checkbox" id="toggle-particles"></label>
  <label>Card Size: <input type="range" id="card-size" min="200" max="320" value="260"></label>
  <label>Background Colors:
    <input type="color" id="bg-color1" value="#000000">
    <input type="color" id="bg-color2" value="#ff6600">
  </label>
  <label>Accent Color: <input type="color" id="accent-color" value="#ff8800"></label>
  <button id="close-settings">Close</button>
</div>

<div id="decorations-container"></div>

<div class="game-list" id="game-list"></div>
<iframe id="game-frame"></iframe>

<script>
// -------- Save/Load Settings --------
const savedSettings = JSON.parse(localStorage.getItem('mlSettings')) || {};
function saveSettings(){localStorage.setItem('mlSettings',JSON.stringify(savedSettings));}

// -------- Decorations --------
const decorationsContainer = document.getElementById('decorations-container');
const decoEmojis = ["üéÉ","üíÄ","üï∏Ô∏è"];
function createDecorations(count=25){
  decorationsContainer.innerHTML="";
  for(let i=0;i<count;i++){
    const deco = document.createElement('div');
    deco.className='decoration';
    deco.style.left=Math.random()*100+"vw";
    deco.style.top=Math.random()*100+"vh";
    deco.style.fontSize=(20+Math.random()*20)+"px";
    deco.style.opacity=0.6+Math.random()*0.4;
    deco.textContent=decoEmojis[Math.floor(Math.random()*decoEmojis.length)];
    decorationsContainer.appendChild(deco);
  }
}
createDecorations();
const toggleDeco = document.getElementById('toggle-decorations');
toggleDeco.checked = savedSettings.decorations !== undefined ? savedSettings.decorations : true;
decorationsContainer.style.display = toggleDeco.checked ? "block" : "none";
toggleDeco.addEventListener('change',()=>{decorationsContainer.style.display=toggleDeco.checked?"block":"none"; savedSettings.decorations=toggleDeco.checked; saveSettings();});

// -------- Particles --------
const canvas = document.getElementById('particles');
const ctx = canvas.getContext('2d');
canvas.width = innerWidth; canvas.height = innerHeight;
let particles = [];
function initParticles(count=60){
  particles=[];
  for(let i=0;i<count;i++){
    particles.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:Math.random()*2+1,dx:(Math.random()-0.5)*0.5,dy:(Math.random()-0.5)*0.5});
  }
}
initParticles();
function animateParticles(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  if(document.getElementById('toggle-particles').checked){
    ctx.fillStyle="#ff8800";
    particles.forEach(p=>{
      ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill();
      p.x+=p.dx; p.y+=p.dy;
      if(p.x<0||p.x>canvas.width)p.dx*=-1;
      if(p.y<0||p.y>canvas.height)p.dy*=-1;
    });
  }
  requestAnimationFrame(animateParticles);
}
animateParticles();
const toggleParticles=document.getElementById('toggle-particles');
toggleParticles.checked=savedSettings.particles!==undefined?savedSettings.particles:true;
toggleParticles.addEventListener('change',()=>{savedSettings.particles=toggleParticles.checked; saveSettings();});

// -------- Games --------
const games=[
"Ragdoll archers","Ragdoll hit","Time shooter","Retro bowl",
"Snow rider","Swords and sandals","Crazy cattle","Gladi hoppers",
"Bit planes","Final earth2","Cluster rush","Push your luck",
"Poly track","Ragdoll Soccer","Jetpack joy ride","Learn to fly 3",
"Malidin stun cars","Gun spin","Age of war","Moto x3m 2",
"Moto x3m winter","Basketball stars","Idle breakout",
"Vex 8","Tiny fishing","Drive mad","Stick man hook","Learn to fly 2",
"Line rider","Unicycle hero","Basket random","1v1 lol","Happy wheels",
"Idle dice","Idle miner tycoon","Johnny upgrade","Jack smith","Tunnel rush",
"Duck life 5","Duck life 4","Mob control","A small world cup","Escape road",
"QWOP","Indian truck simulator","Mr mine clone","Doge miner","Draw climber","Granny online"
];
const gameList=document.getElementById("game-list");
let favorites = JSON.parse(localStorage.getItem("mlFavorites"))||[];
function saveFavorites(){localStorage.setItem("mlFavorites",JSON.stringify(favorites));}
function renderGames(){
  gameList.innerHTML="";
  const sorted=[...games].sort((a,b)=>a.localeCompare(b));
  const favs=sorted.filter(g=>favorites.includes(g));
  const nonFavs=sorted.filter(g=>!favorites.includes(g));
  [...favs,...nonFavs].forEach(name=>{
    const card=document.createElement("div");
    card.className="game-card";
    card.style.width=document.getElementById('card-size').value+"px";
    card.innerHTML=`<div class='star ${favorites.includes(name)?'favorited':''}'>‚òÖ</div>${name}`;
    card.onclick=()=>openGame(name);
    card.querySelector(".star").onclick=(e)=>{e.stopPropagation(); if(favorites.includes(name)){favorites=favorites.filter(f=>f!==name);}else{favorites.push(name);} saveFavorites(); renderGames();};
    gameList.appendChild(card);
  });
}
renderGames();

function openGame(name){
  const frame=document.getElementById('game-frame');
  frame.style.display="block";
  frame.src="https://example.com/"+encodeURIComponent(name);
  document.getElementById("back-btn").style.display="block";
  document.getElementById("fullscreen-btn").style.display="block";
  gameList.style.display="none";
}
document.getElementById("back-btn").onclick=()=>{document.getElementById('game-frame').style.display="none";document.getElementById('back-btn').style.display="none";document.getElementById('fullscreen-btn').style.display="none";gameList.style.display="flex";};
document.getElementById("fullscreen-btn").onclick=()=>{const frame=document.getElementById('game-frame'); if(frame.requestFullscreen) frame.requestFullscreen();};

document.getElementById("settings-btn").onclick=()=>document.getElementById("settings-menu").classList.add("open");
document.getElementById("close-settings").onclick=()=>document.getElementById("settings-menu").classList.remove("open");

document.getElementById('card-size').value=savedSettings.cardSize||260;
document.getElementById('card-size').addEventListener('input',e=>{savedSettings.cardSize=e.target.value; saveSettings(); renderGames();});

// Color customization
document.getElementById('bg-color1').value=savedSettings.bg1||'#000000';
document.getElementById('bg-color2').value=savedSettings.bg2||'#ff6600';
document.getElementById('accent-color').value=savedSettings.accent||'#ff8800';
function updateColors(){
  const bg1=document.getElementById('bg-color1').value;
  const bg2=document.getElementById('bg-color2').value;
  const accent=document.getElementById('accent-color').value;
  document.documentElement.style.setProperty('--bg1',bg1);
  document.documentElement.style.setProperty('--bg2',bg2);
  document.documentElement.style.setProperty('--accent',accent);
  savedSettings.bg1=bg1; savedSettings.bg2=bg2; savedSettings.accent=accent;
  saveSettings();
}
document.getElementById('bg-color1').addEventListener('input',updateColors);
document.getElementById('bg-color2').addEventListener('input',updateColors);
document.getElementById('accent-color').addEventListener('input',updateColors);

// -------- Search --------
document.getElementById('search-input').addEventListener('input',()=>{
  const val=document.getElementById('search-input').value.toLowerCase();
  document.querySelectorAll('.game-card').forEach(c=>{
    if(c.textContent.toLowerCase().includes(val)) c.style.display='block';
    else c.style.display='none';
  });
});

// Resize canvas
window.addEventListener('resize',()=>{canvas.width=innerWidth;canvas.height=innerHeight;});
</script>
</body>
</html>
